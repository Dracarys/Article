【原】Work Flow Of Hotspot Helper

苹果在iOS 9.0 开始在NetworkExtension框架中开放与WiFi热点相关的API，就是本文要讨论的NEHotspotHelper。

NEHotspotHelper给予App参与Wi-Fi／热点连接的处理过程的机会，诸如此类的应用我们称之为‘热点助手’，系统允许热点助手通过接受命令来参与到连接热点网络的处理事务中。

当开始尝试连接一个热点网络时，系机（网络状态及）首先开始进行评估。在这个阶段，所有注册的热点助手都会受到一条要求评估该热点的命令。如果有一个以上的热点助手向系统表示自己可以处理该连接事务，那么系统会选择信任级最高的一个，随之进入鉴权阶段。为优化效率，第一个信任级最高的热点助手将被接纳，其余将被忽略掉。（类似受精的过程）

如果没有热点助手可以处理该来接事务，那么系统将直接进入鉴权过程。

在鉴权阶段，被系统接纳的热点助手将受到一条要求鉴权的命令。热点助手负责执行一切网络所需的必要处理，以保证网络连接成功和运行。如果通过，那么热点助手将得到一条成功信息，此时系统将进入已鉴权阶段。

对于那些已经经过热点助手鉴权的热点网络，一旦再次连接，系统将直接进入维持状态，并且在系统与该网络连接期间，持续处于该状态。热点助手在该阶段，将负责处理一切用以维持连接该网络的事务，只要网络通，热点助手就会返回成功，一旦返回失败，或者返回需要鉴权，那么系统将再次进入鉴权阶段。

 在鉴权阶段，如果热点助手侦测到需要用户参与，那么热点助手首先以本地通知的方式提示用户，之后返回一个UIRequired的结果，系统将进入进入交互状态。
 
 在交互状态，热点助手将受到一条交互状态的命令，该阶段热点助手将不会继续在后台工作，交互方式取决于用户是通过通知或还是直接唤起应用。一旦热点助手得从用户那里得到必要信息，将返回成功随即进入已鉴权状态。
 
 除之前介绍的命令，热点助手任何时候都有可能受到一个列表，给予响应数据，热点助手需要标示出列表中的哪些网络可以处理。
 